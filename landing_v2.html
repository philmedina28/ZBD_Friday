<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guess the Tune!</title>
  <style>
    body {
      background: url('./Resources/music-karaoke-party-vivid-background-free-photo.jpg') center center/cover no-repeat fixed;
      font-family: 'Bungee', 'Arial Black', 'Impact', sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      color: #fff;
      overflow-x: hidden;
    }
    .marquee-vertical {
      position: fixed;
      top: 0;
      width: 48px;
      height: 100vh;
      overflow: hidden;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
      pointer-events: none;
    }
    .marquee-vertical.left {
      left: 0;
      background: linear-gradient(135deg, #fbc2eb 0%, #fcb69f 60%, #a1c4fd 100%);
      border-top-right-radius: 24px;
      border-bottom-right-radius: 24px;
      box-shadow: 2px 0 18px #ffb34755, 0 0 24px #a1c4fd33;
    }
    .marquee-vertical.right {
      right: 0;
      background: linear-gradient(225deg, #fbc2eb 0%, #fcb69f 60%, #a1c4fd 100%);
      border-top-left-radius: 24px;
      border-bottom-left-radius: 24px;
      box-shadow: -2px 0 18px #ffb34755, 0 0 24px #a1c4fd33;
    }
    .marquee-track {
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: marquee-scroll 14s linear infinite;
    }
    .marquee-vertical.right .marquee-track {
      animation-direction: reverse;
      animation-duration: 18s;
    }
    @keyframes marquee-scroll {
      0% { transform: translateY(0); }
      100% { transform: translateY(-50%); }
    }
    .marquee-icon {
      font-size: 2.3rem;
      margin: 18px 0;
      filter: drop-shadow(0 2px 6px #fff8) drop-shadow(0 0 8px #ffb34788);
      user-select: none;
      pointer-events: none;
      transition: transform 0.2s;
    }
    .marquee-icon:hover {
      filter: drop-shadow(0 0 24px #ffb347cc) drop-shadow(0 0 16px #a259e6cc) brightness(1.2) saturate(1.3);
      transform: scale(1.18) rotate(-8deg);
      z-index: 2;
    }
    .main-content {
      background: rgba(30, 0, 50, 0.32);
      border-radius: 18px;
      box-shadow: 0 8px 32px #2d003655, 0 2px 8px #fff3;
      backdrop-filter: blur(2.5px);
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 540px;
      margin: 32px auto;
      padding: 0 8px;
    }
    h1 {
      text-align: center;
      font-size: 3.2rem;
      margin-bottom: 18px;
      letter-spacing: 6px;
      background: repeating-linear-gradient(90deg, #fff 0 6px, #ff5e62 6px 12px, #fff 12px 18px, #ffb347 18px 24px);
      -webkit-background-clip: text;
      -webkit-text-fill-color: #fff;
      color: #fff;
      text-shadow:
        0 0 12px #fff,
        0 0 32px #fff,
        0 0 48px #ff5e62,
        0 0 80px #ff5e62,
        0 0 120px #ffb347,
        0 0 160px #ffb347,
        0 0 200px #fff8,
        0 0 8px #000b;
      animation: neon-flicker 2.5s infinite alternate;
      text-transform: uppercase;
    }
    @keyframes neon-flicker {
      0%, 100% { text-shadow:
        0 0 8px #fff,
        0 0 16px #fff,
        0 0 24px #ff5e62,
        0 0 40px #ff5e62,
        0 0 60px #a259e6,
        0 0 80px #ffb347,
        0 0 100px #fff8; }
      10% { text-shadow:
        0 0 12px #fff,
        0 0 24px #ff5e62,
        0 0 48px #ff5e62,
        0 0 80px #a259e6,
        0 0 120px #ffb347,
        0 0 140px #fff8; }
      20% { text-shadow:
        0 0 6px #fff,
        0 0 12px #ff5e62,
        0 0 24px #ff5e62,
        0 0 40px #a259e6,
        0 0 60px #ffb347,
        0 0 80px #fff8; }
      30% { text-shadow:
        0 0 16px #fff,
        0 0 32px #ff5e62,
        0 0 64px #ff5e62,
        0 0 100px #a259e6,
        0 0 140px #ffb347,
        0 0 180px #fff8; }
      40% { text-shadow:
        0 0 8px #fff,
        0 0 16px #ff5e62,
        0 0 32px #ff5e62,
        0 0 60px #a259e6,
        0 0 100px #ffb347,
        0 0 120px #fff8; }
      50% { text-shadow:
        0 0 20px #fff,
        0 0 40px #ff5e62,
        0 0 80px #ff5e62,
        0 0 120px #a259e6,
        0 0 160px #ffb347,
        0 0 200px #fff8; }
      60% { text-shadow:
        0 0 10px #fff,
        0 0 20px #ff5e62,
        0 0 40px #ff5e62,
        0 0 80px #a259e6,
        0 0 120px #ffb347,
        0 0 160px #fff8; }
      70% { text-shadow:
        0 0 14px #fff,
        0 0 28px #ff5e62,
        0 0 56px #ff5e62,
        0 0 90px #a259e6,
        0 0 130px #ffb347,
        0 0 170px #fff8; }
      80% { text-shadow:
        0 0 8px #fff,
        0 0 16px #ff5e62,
        0 0 32px #ff5e62,
        0 0 60px #a259e6,
        0 0 100px #ffb347,
        0 0 120px #fff8; }
      90% { text-shadow:
        0 0 18px #fff,
        0 0 36px #ff5e62,
        0 0 72px #ff5e62,
        0 0 110px #a259e6,
        0 0 150px #ffb347,
        0 0 190px #fff8; }
    }
    .neon-flare {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 220px;
      height: 60px;
      pointer-events: none;
      z-index: 1;
      background: radial-gradient(circle, #fff8 0%, #ff5e6244 40%, #a259e600 80%);
      filter: blur(8px) brightness(1.5);
      opacity: 0.7;
      animation: flare-move 2.5s infinite alternate;
    }
    @keyframes flare-move {
      0% { left: 45%; top: 48%; opacity: 0.7; }
      50% { left: 55%; top: 52%; opacity: 1; }
      100% { left: 50%; top: 50%; opacity: 0.7; }
    }
    .bar-chart {
      background: rgba(30,0,50,0.22);
      border-radius: 14px;
      padding: 10px 4px 0 4px;
      box-shadow: 0 4px 24px #a259e655, 0 2px 8px #fff3;
      position: relative;
      backdrop-filter: blur(1.5px);
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      height: 120px;
      margin-bottom: 18px;
    }
    .bar {
      flex: 1;
      margin: 0 2px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      position: relative;
    }
    .bar-rect {
      width: 28px;
      border-radius: 10px 10px 0 0;
      background: linear-gradient(135deg, #ff5e62 0%, #ffb347 50%, #a259e6 100%);
      transition: height 0.3s cubic-bezier(.68,-0.55,.27,1.55), box-shadow 0.2s;
      box-shadow: 0 0 16px 4px #ffb347cc, 0 0 24px 8px #a259e6cc, 0 0 8px #fff8;
      margin-bottom: 6px;
      cursor: pointer;
      position: relative;
      filter: brightness(1.18) saturate(1.5);
    }
    .bar-rect:hover {
      box-shadow: 0 0 0 8px #ffb34755, 0 0 16px #a1c4fd88;
      filter: brightness(1.18) saturate(1.3);
    }
    .bar-label {
      font-size: 1.05rem;
      font-weight: bold;
      color: #fff;
      text-shadow: 0 2px 8px #a259e6, 0 0 8px #fff8;
    }
    .bar-score {
      font-size: 1.1rem;
      color: #ffb347;
      margin-bottom: 1px;
      font-weight: bold;
      text-shadow: 0 2px 8px #fff8;
    }
    .bar-emoji {
      position: absolute;
      left: 50%;
      top: -28px;
      transform: translateX(-50%);
      font-size: 1.5rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s, top 0.5s;
      filter: drop-shadow(0 0 8px #ffb34788);
    }
    .bar-emoji.active {
      opacity: 1;
      top: -38px;
      animation: pop-emoji 0.7s cubic-bezier(.68,-0.55,.27,1.55);
    }
    @keyframes pop-emoji {
      0% { opacity: 0; top: -28px; }
      30% { opacity: 1; top: -38px; }
      80% { opacity: 1; top: -38px; }
      100% { opacity: 0; top: -48px; }
    }
    .names-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 8px;
    }
    .name-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(30,0,50,0.32);
      border-radius: 10px;
      padding: 8px 10px;
      box-shadow: 0 2px 12px #a259e655, 0 1px 4px #fff3;
      transition: background 0.2s;
      backdrop-filter: blur(1.5px);
    }
    .name-row:hover {
      background: rgba(162,89,230,0.28);
      box-shadow: 0 4px 24px #a259e655, 0 2px 8px #fff8;
    }
    .name {
      font-size: 1.1rem;
      font-weight: bold;
      color: #fff;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 10px;
      text-shadow: 0 2px 8px #a259e6, 0 0 8px #fff8;
    }
    .head-img {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #a259e6;
      box-shadow: 0 2px 12px #a259e655, 0 0 8px #fff8;
      animation: bobbing 1.2s infinite cubic-bezier(.68,-0.55,.27,1.55);
      background: #fff;
    }
    @keyframes bobbing {
      0% { transform: translateY(0) rotate(-6deg); }
      20% { transform: translateY(-7px) rotate(6deg); }
      40% { transform: translateY(0) rotate(-6deg); }
      60% { transform: translateY(7px) rotate(6deg); }
      80% { transform: translateY(0) rotate(-6deg); }
      100% { transform: translateY(0) rotate(-6deg); }
    }
    @keyframes icon-glow-bounce {
      0% {
        filter: drop-shadow(0 0 0px #ffb347) drop-shadow(0 0 0px #fff8);
        transform: scale(1) rotate(-6deg);
      }
      20% {
        filter: drop-shadow(0 0 16px #ffb347) drop-shadow(0 0 8px #fff8);
        transform: scale(1.18) rotate(6deg);
      }
      40% {
        filter: drop-shadow(0 0 24px #ffb347) drop-shadow(0 0 16px #fff8);
        transform: scale(1.08) rotate(-6deg);
      }
      60% {
        filter: drop-shadow(0 0 16px #ffb347) drop-shadow(0 0 8px #fff8);
        transform: scale(1.12) rotate(6deg);
      }
      80% {
        filter: drop-shadow(0 0 8px #ffb347) drop-shadow(0 0 4px #fff8);
        transform: scale(1.04) rotate(-6deg);
      }
      100% {
        filter: drop-shadow(0 0 0px #ffb347) drop-shadow(0 0 0px #fff8);
        transform: scale(1) rotate(-6deg);
      }
    }
    .head-img.animated {
      animation: icon-glow-bounce 0.7s cubic-bezier(.68,-0.55,.27,1.55);
      z-index: 2;
    }
    .score-btn {
      background: linear-gradient(135deg, #a259e6 0%, #ffb347 100%);
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 9px 20px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 16px #a259e655, 0 0 8px #fff8;
      transition: transform 0.1s, box-shadow 0.1s, filter 0.2s;
      outline: none;
      text-shadow: 0 2px 8px #fff8;
    }
    .score-btn:hover {
      filter: brightness(1.22) saturate(1.3);
      transform: scale(1.09) rotate(-2deg);
      box-shadow: 0 8px 32px #a259e688, 0 0 16px #fff8;
    }
    .score-btn:active {
      transform: scale(0.96);
      box-shadow: 0 1px 8px #a259e655, 0 0 8px #fff8;
    }
    .confetti {
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 100;
    }
    /* Floating animated gif in the left highlight area */
    .floating-gif {
      position: fixed;
      right: 40px;
      bottom: 30px;
      width: 180px;
      z-index: 100;
      pointer-events: none;
      filter: drop-shadow(0 0 24px #fff8) brightness(1.1);
      animation: float-gif 3.5s ease-in-out infinite alternate;
    }
    @keyframes float-gif {
      0% { transform: translateY(0) scale(1); }
      100% { transform: translateY(-18px) scale(1.04); }
    }
    /* Floating congratulations message */
    .congrats-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2000;
      font-size: 4.2rem;
      font-family: 'Bungee', 'Arial Black', 'Impact', sans-serif;
      font-weight: bold;
      background: linear-gradient(90deg, #ff5e62 0%, #ffb347 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      color: #fff;
      padding: 38px 80px;
      border-radius: 32px;
      border: 4px solid #fff8;
      box-shadow: 0 0 64px 16px #ffb347cc, 0 0 128px 32px #fff8, 0 0 32px #ff5e62;
      text-shadow: 0 0 32px #fff, 0 0 64px #ff5e62, 0 0 96px #ffb347, 0 0 32px #fff8;
      opacity: 0;
      pointer-events: none;
      animation: congrats-fade 2.5s forwards;
    }
    @keyframes congrats-fade {
      0% { opacity: 0; transform: translate(-50%, -60%) scale(0.7); }
      10% { opacity: 1; transform: translate(-50%, -50%) scale(1.25); }
      30% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
      80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
      100% { opacity: 0; transform: translate(-50%, -40%) scale(0.7); }
    }
    @media (max-width: 700px) {
      .marquee-vertical {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <!-- Left Marquee -->
  <div class="marquee-vertical left">
    <div class="marquee-track" id="marqueeLeft">
      <!-- JS will fill icons -->
    </div>
  </div>
  <!-- Right Marquee -->
  <div class="marquee-vertical right">
    <div class="marquee-track" id="marqueeRight">
      <!-- JS will fill icons -->
    </div>
  </div>
  <img src="./Resources/6ov.gif" alt="Loading Character Gif" class="floating-gif" id="dancingGif" style="cursor:pointer;" />
  <div id="fridayVideoWrapper" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:9999; background:#000; align-items:center; justify-content:center;">
    <video id="fridayVideo" src="./Resources/Friday.mov" style="max-width:100vw; max-height:100vh; background:#000;" controls></video>
    <button id="closeFridayVideo" style="position:absolute;top:24px;right:32px;font-size:2rem;background:rgba(0,0,0,0.5);color:#fff;border:none;border-radius:8px;padding:8px 18px;z-index:10001;cursor:pointer;">✕</button>
  </div>
  <div class="main-content">
    <div style="position:relative; display:flex; justify-content:center; align-items:center;">
      <span class="neon-flare"></span>
      <h1>GUESS THE TUNE!</h1>
    </div>
    <div class="bar-chart" id="barChart"></div>
    <div class="names-list" id="namesList"></div>
    <div id="counter-section" style="margin-top:32px; text-align:center;">
      <button id="startCounterBtn" class="score-btn vibrant-btn" style="font-size:2rem; padding:16px 40px; margin-bottom:16px; border: 3px solid #fff; box-shadow: 0 8px 32px #a259e688, 0 0 16px #fff8; background: linear-gradient(90deg, #a259e6 0%, #ffb347 100%); color: #fff; text-shadow: 0 2px 8px #fff8;">Start</button>
      <div id="counterDisplay" style="display:flex; align-items:center; justify-content:center; font-size:4.2rem; font-weight:bold; color:#fff; min-height:80px; margin: 0 auto; letter-spacing: 4px; text-shadow: 0 0 16px #fff, 0 0 32px #ff5e62, 0 0 48px #ffb347, 0 0 64px #fff8, 0 0 8px #a259e6; transition: color 0.3s; text-align:center; white-space:pre-line;"></div>
    </div>
    <audio id="congratsSound" src="./Resources/Hyundai HDT Videoke Score 96 (MASCOT SOUND) (FOR NHAJIA MANSUL).mp3"></audio>
  </div>
  <script>
    // --- Constants ---
    const WINNING_SCORE = 10;
    const ANIMATION_DURATION = 700;
    const CONGRATS_DURATION = 2500;
    const COUNTDOWN_START = 20;
    const APPLAUSE_FADE_DURATION = 1200;
    const APPLAUSE_FADE_STEPS = 24;
    const BAR_EMOJIS = ['🎉','👏','🎵','🥳','✨','🎶'];
    const VIBRANT_GRADIENTS = [
      'linear-gradient(135deg, #ff5e62 0%, #ffb347 100%)',
      'linear-gradient(135deg, #f7971e 0%, #ffd200 100%)',
      'linear-gradient(135deg, #a259e6 0%, #43cea2 100%)',
      'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
      'linear-gradient(135deg, #30cfd0 0%, #a259e6 100%)',
      'linear-gradient(135deg, #ff5e62 0%, #a259e6 100%)'
    ];
    // Vibrant, happy accent colors for bars/buttons/confetti
    const colors = [
      '#a6c1ee', '#fbc2eb', '#fcb69f', '#fdcbf1', '#b5ead7', '#ffdac1'
    ];
    const names = [
      'Kim',
      'Abi',
      'Suzie',
      'Al',
      'Trixy',
      'Frank'
    ];
    let scores = Array(names.length).fill(0);

    // --- Audio Helper Functions ---
    const applause = new Audio('./Resources/applause-2-31567.mp3');
    const beepSound = new Audio('./Resources/20 Second Ticking Countdown Timer With Alarm.mp3');
    let applauseFadeInterval = null;
    let applauseStopTimeout = null;
    let applauseFadeTimeout = null;
    function playApplause() {
      if (applauseFadeInterval) {
        clearInterval(applauseFadeInterval);
        applauseFadeInterval = null;
      }
      if (applauseStopTimeout) {
        clearTimeout(applauseStopTimeout);
        applauseStopTimeout = null;
      }
      if (applauseFadeTimeout) {
        clearTimeout(applauseFadeTimeout);
        applauseFadeTimeout = null;
      }
      applause.currentTime = 1;
      applause.volume = 1;
      applause.play();
      applauseStopTimeout = setTimeout(() => {
        // Fade out over 0.7s (700ms)
        const fadeSteps = 14;
        let step = 0;
        const fadeStepDuration = 700 / fadeSteps;
        applauseFadeInterval = setInterval(() => {
          step++;
          applause.volume = Math.max(0, 1 - step / fadeSteps);
          if (step >= fadeSteps) {
            clearInterval(applauseFadeInterval);
            applauseFadeInterval = null;
            applause.pause();
            applause.currentTime = 1;
            applause.volume = 1;
          }
        }, fadeStepDuration);
      }, 2000);
    }
    function playBeep(time = 1) {
      beepSound.pause();
      beepSound.currentTime = time;
      beepSound.play();
    }
    // --- Fullscreen Helper ---
    function requestFullscreen(elem) {
      if (elem.requestFullscreen) elem.requestFullscreen();
      else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
      else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
      else return false;
      return true;
    }
    function exitFullscreen() {
      if (document.exitFullscreen) document.exitFullscreen();
      else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
      else if (document.msExitFullscreen) document.msExitFullscreen();
    }
    // --- Centralized Score Increment Logic ---
    function incrementScore(i, confettiX, confettiY, img) {
      scores[i]++;
      lastScored = i;
      renderBarChart();
      confettiBurst(confettiX, confettiY);
      playApplause();
      if (img) {
        img.classList.remove('animated');
        void img.offsetWidth;
        img.classList.add('animated');
        setTimeout(() => {
          img.classList.remove('animated');
        }, ANIMATION_DURATION);
      }
      if (scores[i] === WINNING_SCORE) {
        showCongrats();
      }
    }
    // --- Marquee icons ---
    const marqueeIcons = [
      "🎵", "🎶", "🎤", "🎧", "🎹", "🎷", "🎸", "🥁", "🎺", "🎧", "✨", "🥳", "🎉", "👏",
      '<img src="./Resources/clipart1232248.png" alt="TGIF!" style="height:2.3rem;vertical-align:middle;">'
    ];
    function fillMarquee(id) {
      const track = document.getElementById(id);
      // Repeat icons enough to fill and scroll
      let icons = [];
      for (let i = 0; i < 3; i++) icons = icons.concat(marqueeIcons);
      icons.forEach(icon => {
        const el = document.createElement('div');
        el.className = 'marquee-icon';
        if (icon.startsWith('<img')) {
          el.innerHTML = icon;
        } else {
          el.textContent = icon;
        }
        track.appendChild(el);
      });
    }
    fillMarquee('marqueeLeft');
    fillMarquee('marqueeRight');

    // --- Confetti animation ---
    function confettiBurst(x, y) {
      const confetti = document.createElement('canvas');
      confetti.className = 'confetti';
      confetti.width = window.innerWidth;
      confetti.height = window.innerHeight;
      document.body.appendChild(confetti);
      const ctx = confetti.getContext('2d');
      const pieces = [];
      for (let i = 0; i < 32; i++) {
        pieces.push({
          x: x,
          y: y,
          r: Math.random()*8+4,
          color: colors[Math.floor(Math.random()*colors.length)],
          dx: (Math.random()-0.5)*6,
          dy: Math.random()*-6-2,
          dr: (Math.random()-0.5)*0.2,
          angle: Math.random()*Math.PI*2
        });
      }
      let frame = 0;
      function draw() {
        ctx.clearRect(0,0,confetti.width,confetti.height);
        pieces.forEach(p => {
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.angle);
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(0,0,p.r,0,2*Math.PI);
          ctx.fill();
          ctx.restore();
          p.x += p.dx;
          p.y += p.dy;
          p.dy += 0.18;
          p.angle += p.dr;
        });
        frame++;
        if (frame < 50) requestAnimationFrame(draw);
        else confetti.remove();
      }
      draw();
    }

    // --- Bar chart with emoji pop ---
    let lastScored = -1;
    function renderBarChart() {
      const maxScore = Math.max(...scores, 1);
      const barChart = document.getElementById('barChart');
      barChart.innerHTML = '';
      names.forEach((name, i) => {
        const bar = document.createElement('div');
        bar.className = 'bar';
        const barRect = document.createElement('div');
        barRect.className = 'bar-rect';
        barRect.style.height = (scores[i] / maxScore * 80 + 18) + 'px';
        barRect.style.background = VIBRANT_GRADIENTS[i % VIBRANT_GRADIENTS.length];
        barRect.title = `Click to cheer for ${name}!`;
        barRect.setAttribute('aria-label', `Cheer for ${name}`);
        barRect.tabIndex = 0;
        barRect.onclick = (e) => {
          incrementScore(i, window.innerWidth/2, 120);
        };
        barRect.onkeydown = (e) => {
          if (e.key === 'Enter' || e.key === ' ') incrementScore(i, window.innerWidth/2, 120);
        };
        const barScore = document.createElement('div');
        barScore.className = 'bar-score';
        barScore.textContent = scores[i];
        const barLabel = document.createElement('div');
        barLabel.className = 'bar-label';
        barLabel.textContent = name;
        const barEmoji = document.createElement('div');
        barEmoji.className = 'bar-emoji';
        barEmoji.textContent = BAR_EMOJIS[i%BAR_EMOJIS.length];
        if (lastScored === i) {
          barEmoji.classList.add('active');
          setTimeout(() => {
            barEmoji.classList.remove('active');
          }, ANIMATION_DURATION);
        }
        bar.appendChild(barRect);
        bar.appendChild(barEmoji);
        bar.appendChild(barScore);
        bar.appendChild(barLabel);
        barChart.appendChild(bar);
      });
    }

    function renderNamesList() {
      const namesList = document.getElementById('namesList');
      namesList.innerHTML = '';
      names.forEach((name, i) => {
        const row = document.createElement('div');
        row.className = 'name-row';
        const nameDiv = document.createElement('div');
        nameDiv.className = 'name';
        const img = document.createElement('img');
        img.className = 'head-img';
        img.src = `./Pics/${name}.jpeg`;
        img.alt = name;
        img.onerror = function() { this.src = './Resources/music-karaoke-party-vivid-background-free-photo.jpg'; };
        nameDiv.appendChild(img);
        const nameText = document.createElement('span');
        nameText.textContent = name;
        nameDiv.appendChild(nameText);
        const btn = document.createElement('button');
        btn.className = 'score-btn';
        btn.textContent = 'Score!';
        btn.style.background = `linear-gradient(135deg, ${colors[i]} 0%, #f8f8ff 100%)`;
        btn.style.color = '#7f53ac';
        btn.setAttribute('aria-label', `Add score for ${name}`);
        btn.onclick = (e) => {
          const rect = e.target.getBoundingClientRect();
          incrementScore(i, rect.left + rect.width/2, rect.top + rect.height/2, img);
        };
        btn.onkeydown = (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            const rect = btn.getBoundingClientRect();
            incrementScore(i, rect.left + rect.width/2, rect.top + rect.height/2, img);
          }
        };
        row.appendChild(nameDiv);
        row.appendChild(btn);
        namesList.appendChild(row);
      });
    }

    renderBarChart();
    renderNamesList();

    // Countdown Logic
    const startCounterBtn = document.getElementById('startCounterBtn');
    const counterDisplay = document.getElementById('counterDisplay');
    let counterInterval = null;
    startCounterBtn.addEventListener('click', () => {
      let count = COUNTDOWN_START;
      startCounterBtn.disabled = true;
      startCounterBtn.textContent = 'Counting...';
      let localCount = count;
      counterDisplay.textContent = '';
      setTimeout(() => {
        beepSound.pause();
        beepSound.currentTime = 0;
        beepSound.volume = 1;
        beepSound.playbackRate = 1.0;
        beepSound.play();
        counterDisplay.textContent = localCount;
        localCount--;
        counterInterval = setInterval(() => {
          if (localCount > 0) {
            counterDisplay.textContent = localCount;
            localCount--;
          } else {
            clearInterval(counterInterval);
            counterDisplay.textContent = "Time's up!";
            startCounterBtn.disabled = false;
            startCounterBtn.textContent = 'Start';
          }
        }, 1000);
      }, 1000);
    });

    document.addEventListener('DOMContentLoaded', function() {
      const dancingGif = document.getElementById('dancingGif');
      const fridayVideo = document.getElementById('fridayVideo');
      const fridayVideoWrapper = document.getElementById('fridayVideoWrapper');
      const closeFridayVideo = document.getElementById('closeFridayVideo');

      function hideVideo() {
        fridayVideo.pause();
        fridayVideoWrapper.style.display = 'none';
      }

      dancingGif.addEventListener('click', () => {
        fridayVideoWrapper.style.display = 'flex';
        fridayVideo.currentTime = 0;
        fridayVideo.play();
        if (!requestFullscreen(fridayVideoWrapper)) {
          window.open(fridayVideo.src, '_blank');
        }
      });

      closeFridayVideo.addEventListener('click', () => {
        if (document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
          exitFullscreen();
        } else {
          hideVideo();
        }
      });

      fridayVideo.addEventListener('ended', hideVideo);

      document.addEventListener('fullscreenchange', () => {
        if (!document.fullscreenElement) hideVideo();
      });
      document.addEventListener('webkitfullscreenchange', () => {
        if (!document.webkitFullscreenElement) hideVideo();
      });
      document.addEventListener('msfullscreenchange', () => {
        if (!document.msFullscreenElement) hideVideo();
      });
    });

    // Floating congratulations message logic
    function showCongrats() {
      let msg = document.createElement('div');
      msg.className = 'congrats-message';
      msg.textContent = 'Congratulations!';
      document.body.appendChild(msg);
      confettiBurst(window.innerWidth/2, window.innerHeight/2);
      const congratsSound = document.getElementById('congratsSound');
      congratsSound.pause();
      congratsSound.currentTime = 0;
      congratsSound.volume = 1;
      congratsSound.play();
      setTimeout(() => { msg.remove(); }, CONGRATS_DURATION);
    }
  </script>
</body>
</html> 